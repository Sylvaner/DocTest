<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.16"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NextDom: NextDom\Managers\BackupManager Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NextDom
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.16 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_next_dom.html">NextDom</a></li><li class="navelem"><a class="el" href="namespace_next_dom_1_1_managers.html">Managers</a></li><li class="navelem"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html">BackupManager</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="class_next_dom_1_1_managers_1_1_backup_manager-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">NextDom\Managers\BackupManager Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a835ad9bf5d62d48d9ca07ff7b8273c2a"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a835ad9bf5d62d48d9ca07ff7b8273c2a">backup</a> (bool $background=false)</td></tr>
<tr class="separator:a835ad9bf5d62d48d9ca07ff7b8273c2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a876873892b380132b2e3dc077e0bcc27"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a876873892b380132b2e3dc077e0bcc27">createBackup</a> ()</td></tr>
<tr class="separator:a876873892b380132b2e3dc077e0bcc27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ef404a7447c94f6c1241769af5b10aa"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a8ef404a7447c94f6c1241769af5b10aa">getBackupDirectory</a> ()</td></tr>
<tr class="separator:a8ef404a7447c94f6c1241769af5b10aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0378198444b10a7aa1aff7306bb21b8"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#ab0378198444b10a7aa1aff7306bb21b8">getBackupFilename</a> ($name=null)</td></tr>
<tr class="separator:ab0378198444b10a7aa1aff7306bb21b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abbdf062780695b5e6707590ca4dc69a6"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#abbdf062780695b5e6707590ca4dc69a6">backupPlugins</a> ()</td></tr>
<tr class="separator:abbdf062780695b5e6707590ca4dc69a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a132c238557b105f6caf9ce3adeb397b4"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a132c238557b105f6caf9ce3adeb397b4">repairDB</a> ()</td></tr>
<tr class="separator:a132c238557b105f6caf9ce3adeb397b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6638ebeda2346ba33f334aa6fb52e34b"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a6638ebeda2346ba33f334aa6fb52e34b">createDBBackup</a> ($outputFile)</td></tr>
<tr class="separator:a6638ebeda2346ba33f334aa6fb52e34b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26b48767844c2bf75f84ec74d61f5d1c"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a26b48767844c2bf75f84ec74d61f5d1c">createBackupArchive</a> (string $outputPath, $sqlPath, $cachePath, $logFile)</td></tr>
<tr class="separator:a26b48767844c2bf75f84ec74d61f5d1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62552a70b78d9cf0aec7466739791389"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a62552a70b78d9cf0aec7466739791389">rotateBackups</a> (string $backupDir)</td></tr>
<tr class="separator:a62552a70b78d9cf0aec7466739791389"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affd11789314c701c049b741cdee30072"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#affd11789314c701c049b741cdee30072">getBackupFileInfo</a> ($backupDir, $order=&quot;newest&quot;)</td></tr>
<tr class="separator:affd11789314c701c049b741cdee30072"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a972be19e2088b81197f0b38a17dc627b"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a972be19e2088b81197f0b38a17dc627b">sendRemoteBackup</a> (string $path)</td></tr>
<tr class="separator:a972be19e2088b81197f0b38a17dc627b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a01d48779c28d4791e37f7aacb52dad97"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a01d48779c28d4791e37f7aacb52dad97">restore</a> (string $file='', bool $background=false)</td></tr>
<tr class="separator:a01d48779c28d4791e37f7aacb52dad97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab8964c65d2725c0aafa81627991b91b"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#aab8964c65d2725c0aafa81627991b91b">restoreBackup</a> ($file='')</td></tr>
<tr class="separator:aab8964c65d2725c0aafa81627991b91b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0ff70221f230b897a741018b50b635c"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#ab0ff70221f230b897a741018b50b635c">getLastBackupFilePath</a> ($backupDir, $order=&quot;newest&quot;)</td></tr>
<tr class="separator:ab0ff70221f230b897a741018b50b635c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabb21ff460172ec2e15b1b99f79051e9"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#aabb21ff460172ec2e15b1b99f79051e9">loadSQLFromFile</a> ($file)</td></tr>
<tr class="separator:aabb21ff460172ec2e15b1b99f79051e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd148977007a9b3c431ec2b7ad49a931"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#afd148977007a9b3c431ec2b7ad49a931">listBackup</a> ()</td></tr>
<tr class="separator:afd148977007a9b3c431ec2b7ad49a931"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5d05a1fc2af4e69f9366fe0407e00d9"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#ad5d05a1fc2af4e69f9366fe0407e00d9">removeBackup</a> (string $backupFilePath)</td></tr>
<tr class="separator:ad5d05a1fc2af4e69f9366fe0407e00d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a24977e0aacd1216c8acacb2a036c28b9"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a24977e0aacd1216c8acacb2a036c28b9">extractArchive</a> ($file)</td></tr>
<tr class="separator:a24977e0aacd1216c8acacb2a036c28b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74738b303a34d135683db78fa6ad80b8"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a74738b303a34d135683db78fa6ad80b8">restoreDatabase</a> ($tmpDir)</td></tr>
<tr class="separator:a74738b303a34d135683db78fa6ad80b8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aee469b251e9d572773096fa2372b52"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a5aee469b251e9d572773096fa2372b52">loadSQLMigrateScript</a> ()</td></tr>
<tr class="separator:a5aee469b251e9d572773096fa2372b52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a026b6cb20254bb67cea3cd95536901de"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a026b6cb20254bb67cea3cd95536901de">restoreJeedomConfig</a> (string $tmpDir)</td></tr>
<tr class="separator:a026b6cb20254bb67cea3cd95536901de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a290526644e225e608449ff9e21c0dea0"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a290526644e225e608449ff9e21c0dea0">restoreCustomData</a> ($tmpDir, $logFile)</td></tr>
<tr class="separator:a290526644e225e608449ff9e21c0dea0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a131e791181e1a13b19d621d3f8ca5408"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a131e791181e1a13b19d621d3f8ca5408">restorePlugins</a> ($tmpDir)</td></tr>
<tr class="separator:a131e791181e1a13b19d621d3f8ca5408"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15ab2ae000b6c5b11f3767056b51d677"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a15ab2ae000b6c5b11f3767056b51d677">restorePublicPerms</a> ($folderRoot)</td></tr>
<tr class="separator:a15ab2ae000b6c5b11f3767056b51d677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83d1fa94e3bfe6758b8e7d0cef56b62e"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#a83d1fa94e3bfe6758b8e7d0cef56b62e">updateConfig</a> ()</td></tr>
<tr class="separator:a83d1fa94e3bfe6758b8e7d0cef56b62e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2eb9348be9df222097cadb852a1408f"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_next_dom_1_1_managers_1_1_backup_manager.html#aa2eb9348be9df222097cadb852a1408f">addPathToArchive</a> ( $roots, $pattern, $tar, $logFile)</td></tr>
<tr class="separator:aa2eb9348be9df222097cadb852a1408f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aa2eb9348be9df222097cadb852a1408f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2eb9348be9df222097cadb852a1408f">&#9670;&nbsp;</a></span>addPathToArchive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::addPathToArchive </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$roots</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$pattern</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tar</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">array</td><td class="paramname">$roots</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$pattern</td><td></td></tr>
    <tr><td class="paramtype">Tar</td><td class="paramname">$tar</td><td></td></tr>
    <tr><td class="paramtype"></td><td class="paramname">string</td><td>logFile </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a835ad9bf5d62d48d9ca07ff7b8273c2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a835ad9bf5d62d48d9ca07ff7b8273c2a">&#9670;&nbsp;</a></span>backup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::backup </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>$background</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a backup archive</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">bool</td><td class="paramname">$background</td><td>Lancer la sauvegarde en tâche de fond. </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="abbdf062780695b5e6707590ca4dc69a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abbdf062780695b5e6707590ca4dc69a6">&#9670;&nbsp;</a></span>backupPlugins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::backupPlugins </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Runs backup method for each active plugins if available</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a876873892b380132b2e3dc077e0bcc27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a876873892b380132b2e3dc077e0bcc27">&#9670;&nbsp;</a></span>createBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::createBackup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Runs the backup procedure</p>
<p>Last output should not be removed since it act as a marker in ajax calls</p>
<dl class="section return"><dt>Returns</dt><dd>bool true if no error </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a26b48767844c2bf75f84ec74d61f5d1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26b48767844c2bf75f84ec74d61f5d1c">&#9670;&nbsp;</a></span>createBackupArchive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::createBackupArchive </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>$outputPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$sqlPath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$cachePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates an archive with all files that should be included in backup</p>
<p>We proceed in 4 steps:</p><ol type="1">
<li>creates a tar archive with plugins</li>
<li>append mysql backup to tar archive</li>
<li>append cache to to tar archive</li>
<li>compress tar archive</li>
</ol>
<p>This allows to untie path dependencies between source files while keeping the same directory structure in the tar archive (in order to keep backward compatibility with jeedom archives).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$outputPath</td><td>path of generated backup archive </td></tr>
    <tr><td class="paramtype"></td><td class="paramname">$sqlPath</td><td></td></tr>
    <tr><td class="paramtype"></td><td class="paramname">$cachePath</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a6638ebeda2346ba33f334aa6fb52e34b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6638ebeda2346ba33f334aa6fb52e34b">&#9670;&nbsp;</a></span>createDBBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::createDBBackup </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$outputFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a backup of database to given output file path</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$outputFile</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td>true when mysqldump failed </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a24977e0aacd1216c8acacb2a036c28b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24977e0aacd1216c8acacb2a036c28b9">&#9670;&nbsp;</a></span>extractArchive()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::extractArchive </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Extracts backup archive to a temporary folder</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>path to backup archive </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string path to generated temporary directory </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td></td></tr>
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a8ef404a7447c94f6c1241769af5b10aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ef404a7447c94f6c1241769af5b10aa">&#9670;&nbsp;</a></span>getBackupDirectory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::getBackupDirectory </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns backup directory according to backup::path</p>
<p>When backup::path is relative, constructs directory from NEXTDOM_DATA root</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td>if backup directory cannot be created @retrun string backup root directory </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="affd11789314c701c049b741cdee30072"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affd11789314c701c049b741cdee30072">&#9670;&nbsp;</a></span>getBackupFileInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::getBackupFileInfo </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$backupDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$order</em> = <code>&quot;newest&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates an array with information about existing backup files</p>
<p>Available fields:</p><ul>
<li>file: path to backup archive</li>
<li>mtime: current file modification timestamp</li>
<li>size: file size in bytes</li>
</ul>
<ol type="1">
<li>get file list from globing</li>
<li>generate array of object from file list</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$backupDir</td><td>backup root directory </td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$order</td><td>sort result by 'newest' or 'oldest' first </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>array @retrun array of file object </dd></dl>

</div>
</div>
<a id="ab0378198444b10a7aa1aff7306bb21b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0378198444b10a7aa1aff7306bb21b8">&#9670;&nbsp;</a></span>getBackupFilename()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::getBackupFilename </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$name</em> = <code>null</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Computes backup filename from nextdom's name and current datetime</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$name</td><td>current nextdom name, default given by <a class="el" href="class_next_dom_1_1_managers_1_1_config_manager.html">ConfigManager</a> </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ab0ff70221f230b897a741018b50b635c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0ff70221f230b897a741018b50b635c">&#9670;&nbsp;</a></span>getLastBackupFilePath()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::getLastBackupFilePath </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$backupDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$order</em> = <code>&quot;newest&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns path to last available backup archive</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype"></td><td class="paramname">$backupDir</td><td></td></tr>
    <tr><td class="paramtype">string</td><td class="paramname">$order</td><td>sort result by 'newest' or 'oldest' first </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>string archive file path </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td>when no archive is found </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="afd148977007a9b3c431ec2b7ad49a931"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd148977007a9b3c431ec2b7ad49a931">&#9670;&nbsp;</a></span>listBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::listBackup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Obtenir la liste des sauvegardes</p>
<dl class="section return"><dt>Returns</dt><dd>array Liste des sauvegardes </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aabb21ff460172ec2e15b1b99f79051e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aabb21ff460172ec2e15b1b99f79051e9">&#9670;&nbsp;</a></span>loadSQLFromFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::loadSQLFromFile </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Load given file in mysql database</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>path to file to load </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td></td></tr>
    <tr><td class="paramname">CoreException</td><td>when a mysql error occurs </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a5aee469b251e9d572773096fa2372b52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5aee469b251e9d572773096fa2372b52">&#9670;&nbsp;</a></span>loadSQLMigrateScript()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::loadSQLMigrateScript </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Loads migrate script into mysql database</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td>from RestoreManager::loadSQLFromFile </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="ad5d05a1fc2af4e69f9366fe0407e00d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5d05a1fc2af4e69f9366fe0407e00d9">&#9670;&nbsp;</a></span>removeBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::removeBackup </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>$backupFilePath</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Remove a backup file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$backupFilePath</td><td>Backup file path</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a132c238557b105f6caf9ce3adeb397b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a132c238557b105f6caf9ce3adeb397b4">&#9670;&nbsp;</a></span>repairDB()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::repairDB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Checks and repair database</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td>when mysqlcheck exited with error status </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a01d48779c28d4791e37f7aacb52dad97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a01d48779c28d4791e37f7aacb52dad97">&#9670;&nbsp;</a></span>restore()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::restore </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>$file</em> = <code>''</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>$background</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Restore a backup from file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>Backup file path </td></tr>
    <tr><td class="paramtype">bool</td><td class="paramname">$background</td><td>Start backup task in background </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aab8964c65d2725c0aafa81627991b91b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab8964c65d2725c0aafa81627991b91b">&#9670;&nbsp;</a></span>restoreBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::restoreBackup </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$file</em> = <code>''</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Runs the restore procedure</p>
<p>Last output should not be removed since it act as a marker in ajax calls</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$file</td><td>path to backup archive, when empty, use last available backup </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool false when error occurs </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a290526644e225e608449ff9e21c0dea0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a290526644e225e608449ff9e21c0dea0">&#9670;&nbsp;</a></span>restoreCustomData()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::restoreCustomData </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tmpDir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$logFile</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Restore custom data from backup archive</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$tmpDir</td><td>extracted backup root directory </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a74738b303a34d135683db78fa6ad80b8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74738b303a34d135683db78fa6ad80b8">&#9670;&nbsp;</a></span>restoreDatabase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::restoreDatabase </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tmpDir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Loads mysql dump from backup archive into database</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$tmpDir</td><td>extracted backup root directory </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td>when error occurs </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a026b6cb20254bb67cea3cd95536901de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a026b6cb20254bb67cea3cd95536901de">&#9670;&nbsp;</a></span>restoreJeedomConfig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::restoreJeedomConfig </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>$tmpDir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Import common config if not already exists</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$tmpDir</td><td>extracted backup root directory </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a131e791181e1a13b19d621d3f8ca5408"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a131e791181e1a13b19d621d3f8ca5408">&#9670;&nbsp;</a></span>restorePlugins()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::restorePlugins </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$tmpDir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Restore plugins from backup archive</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$tmpDir</td><td>extracted backup root directory </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a15ab2ae000b6c5b11f3767056b51d677"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15ab2ae000b6c5b11f3767056b51d677">&#9670;&nbsp;</a></span>restorePublicPerms()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::restorePublicPerms </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$folderRoot</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Restore www-data owner and 775 permissions on directory</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$folderRoot</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname">CoreException</td><td>on permission error </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a62552a70b78d9cf0aec7466739791389"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62552a70b78d9cf0aec7466739791389">&#9670;&nbsp;</a></span>rotateBackups()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::rotateBackups </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>$backupDir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Removes backup archives according to backup::keepDays and backup::maxSize</p>
<ol type="1">
<li>since files are sorted, we can sum-up bytes until limit is reached from that point, remove all other files</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$backupDir</td><td>backup root directory </td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a972be19e2088b81197f0b38a17dc627b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a972be19e2088b81197f0b38a17dc627b">&#9670;&nbsp;</a></span>sendRemoteBackup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::sendRemoteBackup </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>$path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Trigger remote upload for all available repos</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramtype">string</td><td class="paramname">$path</td><td>path to backup archive </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>bool </dd></dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"></td><td></td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a83d1fa94e3bfe6758b8e7d0cef56b62e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a83d1fa94e3bfe6758b8e7d0cef56b62e">&#9670;&nbsp;</a></span>updateConfig()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static NextDom\Managers\BackupManager::updateConfig </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/Managers/<a class="el" href="_backup_manager_8php.html">BackupManager.php</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.16
</small></address>
</body>
</html>
